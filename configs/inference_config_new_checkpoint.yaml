# Inference Configuration for Event-Voxel DEFLARE
# Uses NEW checkpoint: event_voxel_deflare_physics_noRandom_noTen_method/checkpoint_epoch_0031_iter_040000.pth
# For processing event H5 files with the new trained model

# Model configuration (must match trained model exactly)
model:
  name: TrueResidualUNet3D   # âœ… ä½¿ç”¨çœŸæ­£æ®‹å·®å­¦ä¹ 
  backbone: ResidualUNet3D   # åº•å±‚ç½‘ç»œç±»å‹

  # Architecture parameters (MUST match training config exactly)
  in_channels: 1
  out_channels: 1
  f_maps: [32, 64, 128, 256] # å½“å‰é…ç½®: 4å±‚, 707ä¸‡å‚æ•°
  num_levels: 4              # æœ€å¤§æ·±åº¦4å±‚
  layer_order: gcr           # Group normalization + Conv + ReLU
  num_groups: 8              # GroupNormåˆ†ç»„æ•°
  conv_padding: 1            # å·ç§¯padding
  dropout_prob: 0.1          # Dropoutæ¦‚ç‡

  # ğŸ”¥ NEW CHECKPOINT PATH
  path: checkpoints/event_voxel_deflare_physics_noRandom_noTen_method/checkpoint_epoch_0031_iter_040000.pth

# Inference-specific configuration
inference:
  # Input/Output directories (default paths, can be overridden by command line)
  input_dir: "DSEC_data/input"   # Default input directory
  output_dir: "DSEC_data/output" # Default output directory

  # Data processing parameters (must match training exactly)
  sensor_size: [480, 640]       # Sensor resolution (H, W)
  segment_duration_us: 20000    # 20ms per segment
  num_bins: 8                   # 8 temporal bins per segment
  num_segments: 5               # 5 segments per 100ms input file

  # Device configuration
  device: cuda                  # Use GPU if available

  # Processing parameters
  batch_size: 1                 # Process segments individually

# Debug visualization (controlled by --debug flag)
debug:
  enabled: false               # Controlled by command line --debug flag
  output_dir: debug_output     # Directory for debug visualizations
  max_segments_to_visualize: 3 # Max segments per file to visualize

# Device configuration
device: cuda                    # Use GPU for inference

# Logging
logger:
  name: TensorBoardLogger
  log_dir: logs/inference_new_checkpoint

# Random seed for reproducibility
manual_seed: 42
